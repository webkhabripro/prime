<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Player - demo</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon.png">
  <link rel="stylesheet" href="assets/css/global.css">
  <link rel="stylesheet" href="assets/css/header.css">
  <link rel="stylesheet" href="assets/css/footer.css">
  <link rel="stylesheet" href="assets/css/home.css">
  <style>
    /* Player page specific styles */
    .player-hero {
      max-width: 900px;
      margin: 18px auto;
      background: #111;
      border-radius: 8px;
      padding: 12px;
      color: #fff;
    }
    .player-thumb {
      position: relative;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid red;
    }
    .player-thumb img, .player-thumb video {
      width: 100%;
      display: block;
    }
    .player-play-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80px;
      height: 80px;
      background: rgba(255,255,255,0.12);
      border-radius: 50%;
      display: grid;
      place-items: center;
      cursor: pointer;
      backdrop-filter: blur(3px);
    }
    .player-play-btn::after {
      content: "";
      width: 0; height: 0;
      border-left: 26px solid white;
      border-top: 16px solid transparent;
      border-bottom: 16px solid transparent;
      transform: translateX(6px);
    }

    .buffering-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 14px;
      gap: 10px;
      flex-direction: column;
    }
    .spinner {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 4px solid rgba(255,255,255,0.15);
      border-top-color: white;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg) } }

    .related-section {
      background: #000;
      padding: 12px;
      margin-top: 16px;
      border-radius: 6px;
      color: #fff;
    }
    .related-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 12px;
    }
    .related-item {
      display: flex;
      gap: 8px;
      align-items: center;
      cursor: pointer;
      background: rgba(255,255,255,0.03);
      padding: 6px;
      border-radius: 6px;
      overflow: hidden;
    }
    .related-item img { width: 96px; height: 64px; object-fit: cover; border-radius: 4px; }
    .related-item .r-title { font-size: 13px; color: #eee; }

    /* keep bottom-nav visible like original */
    nav.bottom-nav { position: fixed; bottom: 8px; left: 50%; transform: translateX(-50%); z-index: 1200; }
  </style>
</head>
<body class="home-page">

<header>
  <img src="assets/img/logo.png" class="logo" alt="Site Logo">
  <div class="menu-icon" onclick="toggleMenu()">
    <span></span><span></span><span></span>
  </div>
</header>

<main>
  <div class="player-hero" id="playerHero">
    <h2 id="videoTitle" class="styled-h2">Loading...</h2>

    <div class="player-thumb" id="playerThumb">
      <img id="thumbImg" src="assets/img/deshi1.jpg" alt="thumb">
      <div class="player-play-btn" id="playBtn" title="Play"></div>
    </div>

    <p id="videoDesc" class="red-box" style="margin-top:12px;">&nbsp;</p>
  </div>

  <div class="related-section">
    <h2 class="styled-h2" style="background:#000; color:#fff;">Related Posts</h2>
    <div class="related-grid" id="relatedGrid">
      <!-- filled by JS -->
    </div>
  </div>

</main>

<nav class="bottom-nav">
  <button onclick="window.location.href='/'"><img src="assets/icons/home.png"><span>Home</span></button>
  <button><img src="assets/icons/search.png"><span>Search</span></button>
  <button><img src="assets/icons/saved.png"><span>Saved</span></button>
  <button><img src="assets/icons/login.png"><span>Login</span></button>
  <button onclick="window.location.href='/reels'"><img src="assets/icons/video.png"><span>Reels</span></button>
</nav>

<script>
  // helper: parse query params
  function qp(name, defaultVal) {
    const url = new URL(window.location.href);
    return url.searchParams.get(name) || defaultVal;
  }

  // sample related posts array (uses same images as your site)
  const POSTS = [
    {img:'assets/img/deshi1.jpg', title:'Trending Reels Collection'},
    {img:'assets/img/deshi2.jpg', title:'Latest Entertainment Clips'},
    {img:'assets/img/deshi3.jpg', title:'Viral Indian Reels'},
    {img:'assets/img/deshi4.jpg', title:'Desi Girl Reels'},
    {img:'assets/img/deshi5.jpg', title:'Video HD'}
  ];

  function shuffle(a){
    return a.map(v=>({v, r:Math.random()})).sort((a,b)=>a.r-b.r).map(x=>x.v);
  }

  // populate hero from params
  const title = decodeURIComponent(qp('title','Untitled'));
  const img = decodeURIComponent(qp('img','assets/img/deshi1.jpg'));
  const desc = decodeURIComponent(qp('desc','Catch the hottest viral reels trending right now — updated daily.'));

  document.getElementById('videoTitle').textContent = title;
  document.getElementById('thumbImg').src = img;
  document.getElementById('videoDesc').textContent = desc;

  // play button logic: show buffering for 1.8s then "play"
  const playBtn = document.getElementById('playBtn');
  const playerThumb = document.getElementById('playerThumb');
  let isPlaying = false;

  function showBuffering() {
    const overlay = document.createElement('div');
    overlay.className = 'buffering-overlay';
    overlay.innerHTML = '<div class="spinner"></div><div>Buffering...</div>';
    playerThumb.appendChild(overlay);
    return overlay;
  }

  function afterPlayState() {
    // remove buffering and show a simple playing state (simulated)
    const overlay = playerThumb.querySelector('.buffering-overlay');
    if (overlay) overlay.remove();

    // replace image with a simulated "video" element area
    const existingVideo = playerThumb.querySelector('video');
    if (!existingVideo) {
      const videoEl = document.createElement('div');
      videoEl.style.padding = '60px 20px';
      videoEl.style.textAlign = 'center';
      videoEl.style.fontSize = '18px';
      videoEl.style.color = '#fff';
      videoEl.textContent = 'Playing — simulated video';
      // hide play button
      playBtn.style.display = 'none';
      playerThumb.appendChild(videoEl);
      isPlaying = true;
    }
  }

  playBtn.addEventListener('click', ()=>{
    if (isPlaying) return;
    const buf = showBuffering();
    setTimeout(afterPlayState, 1800);
  });

  // build related grid (random order every load)
  const relatedGrid = document.getElementById('relatedGrid');
  const picks = shuffle(POSTS).slice(0,6);
  picks.forEach(p=>{
    const item = document.createElement('div');
    item.className = 'related-item';
    item.innerHTML = `\n      <img src="${p.img}" alt="thumb">\n      <div><div class="r-title">${p.title}</div></div>\n    `;
    item.addEventListener('click', ()=>{
      // navigate to player.html with params — this page itself — so reload with new params
      const params = new URLSearchParams({ img: p.img, title: p.title, desc: 'Catch the hottest viral reels trending right now — updated daily.' });
      window.location.href = 'player.html?' + params.toString();
    });
    relatedGrid.appendChild(item);
  });

  // toggle menu function (same as original)
  function toggleMenu(){
    document.getElementById('sideMenu')?.classList.toggle('active');
  }

  // expose toggleMenu to global so header menu icon works
  window.toggleMenu = toggleMenu;
</script>

</body>
</html>
